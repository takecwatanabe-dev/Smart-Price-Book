<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Price v9.1</title>
    <link rel="icon" href="https://takecwatanabe-dev.github.io/Smart-Price-Book/icons/icon-512.png?v=91">
    <style>
        body { background: #121212; color: white; font-family: sans-serif; padding: 20px; }
        .header { background: #D50000; padding: 15px; margin: -20px -20px 20px -20px; font-weight: bold; display: flex; justify-content: space-between; }
        .store-list { display: flex; overflow-x: auto; gap: 10px; margin-bottom: 20px; }
        .tag { background: #333; padding: 10px 20px; border-radius: 20px; white-space: nowrap; border: 1px solid #D50000; }
        .tag.active { background: #D50000; }
        .btn { background: #444; color: white; padding: 15px; width: 100%; border: none; border-radius: 10px; margin-bottom: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="header">Smart Price <span>v9.1</span></div>
    
    <p>ğŸ“ ã‚¹ãƒˆã‚¢ãƒªã‚¹ãƒˆ (LocalStorageã‹ã‚‰å¼·åˆ¶å–å¾—)</p>
    <div id="list" class="store-list">èª­ã¿è¾¼ã¿ä¸­...</div>

    <button class="btn" style="background:#D50000" onclick="alert('ã‚¹ã‚­ãƒ£ãƒ³')">ã‚¹ã‚­ãƒ£ãƒ³</button>
    <button class="btn" onclick="location.reload(true)">ã‚¢ãƒ—ãƒªã‚’å¼·åˆ¶æ›´æ–°</button>
    <button class="btn" onclick="location.href=location.href+'?v='+Date.now()">ã‚¢ã‚¤ã‚³ãƒ³å¼·åˆ¶æ›´æ–°(ãƒ–ãƒ©ã‚¦ã‚¶)</button>

    <script>
        // å¤–éƒ¨é€£æºã‚’ä¸€åˆ‡ã›ãšã€ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã ã‘ã‚’å‡ºã™
        window.onload = () => {
            const db = JSON.parse(localStorage.getItem('smart_price_db')) || { products: {} };
            const historySet = new Set();
            Object.values(db.products).forEach(p => {
                p.history?.forEach(h => { if(h.store) historySet.add(h.store); });
            });
            
            const listDiv = document.getElementById('list');
            listDiv.innerHTML = "";
            const stores = [...historySet];
            if(stores.length === 0) stores.push("éå»ã®åº—ãŒã‚ã‚Šã¾ã›ã‚“");
            
            stores.forEach((name, i) => {
                const s = document.createElement('div');
                s.className = 'tag' + (i === 0 ? ' active' : '');
                s.innerText = name;
                listDiv.appendChild(s);
            });
        };
    </script>
</body>
</html>
